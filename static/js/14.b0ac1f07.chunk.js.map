{"version":3,"sources":["assets/audio/wrong4.mp3","pages/LetterTeamsStudy.tsx","componens/study/LetterTeamsQuiz.tsx"],"names":["QuizStatus","LetterTeamsQuiz","syllables","syllableBox","onStudyClear","audioStop","useState","randomAr","setRandomAr","correctAudio","useRef","wrongAudio","onDragCorrect","useCallback","item","area","stopAudio","areaIdx","elementIndex","removeClass","addClass","current","play","nextElementSibling","style","visibility","onDragWrong","stop","useLayoutEffect","makeRandomIgnoreFirst","length","useEffect","Sound","from","url","require","default","preload","destroy","className","Draggable","areaAr","map","syllable","text","dragAr","i","dragElm","isTarget","onDragStart","onCorrect","onWrong","padding","Study","idx","dispatch","stage","useDispatch","studyData","useSelector","state","status","activeIndex","data","list","INIT","quizStatus","setQuizStatus","audioBtn","wordsAudio","audios","timer","audioFinish","isSilent","findIndex","withSilent","withSilient","forEach","setTimeout","START","type","StudyActions","CHANGE_STATUS","payload","StudyStatus","STUDY_END","audio","STUDY_START","clearTimeout","INTRO","box","STUDY_TRANSITION","RESULT","words","ref","letterSpacing","AudioButton","left","top","src","disabled","LetterTeamsStudy","id","store","Store","StudyLayout","title","parseInt","showGameBtn","studyElem"],"mappings":"2HAAA,OAAe,cAA0B,kC,mECepCA,E,yFC8DUC,EAhEoB,SAAC,GAAuD,IAAtDC,EAAqD,EAArDA,UAAWC,EAA0C,EAA1CA,YAAaC,EAA6B,EAA7BA,aAAcC,EAAe,EAAfA,UACxE,EAAgCC,qBAAhC,mBAAOC,EAAP,KAAiBC,EAAjB,KACMC,EAAeC,mBACfC,EAAaD,mBAEbE,EAAgBC,uBAAY,SAACC,EAAsBC,GACtDC,IACA,IAAIC,EAAUC,YAAaH,GAC3BI,YAAYhB,EAAYc,GAAU,UAClCG,YAASjB,EAAYc,GAAU,SAC/BR,EAAaY,QAASC,MAAK,WACrBP,EAAKQ,oBACYR,EAAKQ,mBACbC,MAAMC,WAAa,UAC5BL,YAASjB,EAAYc,EAAQ,GAAI,WAEjCb,GAEL,GACH,GAAE,IAEGsB,EAAcb,uBAAY,SAACC,GAC9BE,IACAL,EAAWU,QAASC,MACtB,GAAE,IAEGN,EAAYH,uBAAY,WAC3BJ,EAAaY,QAASM,OACtBhB,EAAWU,QAASM,MACtB,GAAE,IAiBH,OAfAC,2BAAgB,WACbpB,EAAYqB,YAAsB,EAAG3B,EAAU4B,OAAQ5B,EAAU4B,QACnE,GAAC,IAEFC,qBAAU,WAIP,OAHAX,YAASjB,EAAY,GAAI,UACzBM,EAAaY,QAAUW,IAAMC,KAAK,CAACC,IAAKC,EAAQ,KAAkCC,QAASC,SAAS,IACpG1B,EAAWU,QAAUW,IAAMC,KAAK,CAACC,IAAKC,EAAQ,KAAiCC,QAASC,SAAS,IAC1F,WAAO,IAAD,IACV,UAAA5B,EAAaY,eAAb,SAAsBiB,UACtB,UAAA3B,EAAWU,eAAX,SAAoBiB,SACtB,CACH,GAAE,IAIA,qBAAKC,UAAU,oBAAf,SACIhC,GACE,cAACiC,EAAA,EAAD,CACGC,OAAQvC,EAAUwC,KAAI,SAAAC,GAAQ,OAAIA,EAASC,IAAb,IAC9BC,OAAQtC,EAASmC,KAAI,SAAAI,GAAC,OAAI5C,EAAU4C,GAAGF,IAAjB,IACtBG,QAASxC,EAASmC,KAAK,SAAAI,GAAC,OACrB,sBAAMP,UAAS,UAAKrC,EAAU4C,GAAGE,SAAW,SAAW,IAAvD,SAA8D9C,EAAU4C,GAAGF,MADtD,IAGxBK,YAAa5C,EACb6C,UAAWtC,EACXuC,QAASzB,EACT0B,QAAS,SAIvB,E,wBD5DIpD,K,YAAAA,E,cAAAA,E,eAAAA,M,KAOL,IAAMqD,EAA0C,SAAC,GAAoB,IAAlBC,EAAiB,EAAjBA,IAE1CC,GAF2D,EAAZC,MAEpCC,eACXC,EAAiBC,aAAiB,SAAAC,GAAK,OAAIA,EAAMF,SAAV,IACvCG,EAAcF,aAAiB,SAAAC,GAAK,OAAIA,EAAMC,MAAV,IACpCC,EAAmBH,aAAiB,SAAAC,GAAK,OAAIA,EAAME,WAAV,IACzCC,EAAOL,EAAUM,KAAKV,EAAI,GAEhC,EAAoChD,mBAAqBN,EAAWiE,MAApE,mBAAOC,EAAP,KAAmBC,EAAnB,KACMC,EAAW1D,iBAAwB,MACnCP,EAAcO,iBAAyB,IACvC2D,EAAa3D,mBACb4D,EAAS5D,iBAAgB,IACzB6D,EAAQ7D,mBAER8D,EAAc3D,uBAAY,SAAEyC,GAC/B,IAAMmB,EAAWV,EAAK7D,UAAUwE,WAAU,SAAC/B,GAAD,OAAmBA,EAAS8B,QAA5B,IACpCE,EAAaZ,EAAK7D,UAAUwE,WAAU,SAAC/B,GAAD,OAAmBA,EAASiC,WAA5B,IACtC9C,EAAS2C,GAAY,EAAIV,EAAK7D,UAAU4B,OAAQ,EAAIiC,EAAK7D,UAAU4B,OAEtEwB,GAAOxB,GACP3B,EAAYkB,QAAQwD,SAAQ,SAAAlC,GAAQ,OAAIxB,YAAYwB,EAAU,UAA1B,IACpC4B,EAAMlD,QAAUyD,YAAW,WACrBxB,GAAOxB,GACPuC,EAAWhD,QAASC,MAAK,kBAAMkD,EAAYlB,EAAI,EAAtB,IACzBnD,EAAYkB,QAAQwD,SAAQ,SAAAlC,GAAQ,OAAIvB,YAASuB,EAAU,UAAvB,KAEjCW,IAAQqB,GACRL,EAAOjD,QAAQiC,GAAKhC,MAAK,kBAAMkD,EAAYlB,EAAM,EAAxB,IACzBlC,YAASjB,EAAYkB,QAAQiC,GAAM,WACnClC,YAASjB,EAAYkB,QAAQoD,GAAW,aAExCH,EAAOjD,QAAQiC,GAAKhC,MAAK,kBAAMkD,EAAYlB,EAAM,EAAxB,IACzBlC,YAASjB,EAAYkB,QAAQiC,GAAM,WAG3C,GAAE,OAEHnD,EAAYkB,QAAQwD,SAAQ,SAAAlC,GAAQ,OAAIxB,YAAYwB,EAAU,UAA1B,IACpCwB,EAAcnE,EAAW+E,OAE9B,GAAE,CAACb,EAAY/D,EAAYkB,UAEtBjB,EAAeS,uBAAY,WAC9B0C,EAAS,CACNyB,KAAMC,IAAaC,cACnBC,QAASC,IAAYC,WAE1B,GAAE,IAEGrE,EAAY,WACfsD,EAAOjD,QAAQwD,SAAQ,SAAAS,GAAK,OAAIA,EAAM3D,MAAV,GAC9B,EA4CD,OAzCAI,qBAAU,WACJ8B,IAAWuB,IAAYG,aACvBC,aAAajB,EAAMlD,SAChBiC,IAAQQ,EAAc,EACtBS,EAAMlD,QAAUyD,YAAW,WACxBX,EAAcnE,EAAWyF,MAC3B,GAAE,MAEHtB,EAAcnE,EAAWiE,MACzBjD,IACAb,EAAYkB,QAAQwD,SAAS,SAAAa,GAC1BvE,YAAYuE,EAAK,WACjBvE,YAAYuE,EAAK,UACjBvE,YAAYuE,EAAK,QACnB,MAEG7B,IAAWuB,IAAYO,kBAAoB9B,IAAWuB,IAAYQ,SACzEJ,aAAajB,EAAMlD,SACnBL,IAEL,GAAE,CAAC6C,IAEJ9B,qBAAU,WACJmC,IAAelE,EAAWyF,QAC1BlB,EAAMlD,QAAUyD,YAAW,WACxBR,EAAOjD,QAAQ,GAAGC,MAAK,kBAAMkD,EAAY,EAAlB,IACvBpD,YAASjB,EAAYkB,QAAQ,GAAI,UACnC,GAAE,KAER,GAAE,CAAC6C,IAEJnC,qBAAU,WACPsC,EAAWhD,QAAUW,IAAMC,KAAK,CAACC,IAAK6B,EAAK8B,MAAMP,MAAOjD,SAAS,IACjE0B,EAAK7D,UAAU2E,SAAQ,SAAClC,EAAeG,GACjCH,EAAS2C,QACThB,EAAOjD,QAAQyB,GAAKd,IAAMC,KAAK,CAACC,IAAKS,EAAS2C,MAAOjD,SAAS,IAEnE,GACH,GAAC,IAIC,qCACG,sBAAKE,UAAU,YAAf,UACG,qBAAKA,UAAU,gBAAf,SACIwB,EAAK7D,UAAUwC,KAAI,SAACC,EAAeG,GAAhB,OACjB,qBAAKgD,IAAK,SAAAA,GAAG,OAAIA,IAAQ3F,EAAYkB,QAAQyB,GAAKgD,EAArC,EACVvD,UAAS,uBAAkBI,EAASK,SAAW,SAAW,IAC1DxB,MAAO,CAACuE,cAAwC,IAAzBpD,EAASC,KAAKd,OAAe,OAAS,OAFhE,SAIIa,EAASC,MAJb,eAGgBE,GAJC,MASvB,cAACkD,EAAA,EAAD,CACGF,IAAK1B,EACL6B,KAAK,OACLC,IAAI,OACJC,IAAKpC,EAAK8B,MAAMP,MAChBc,SACGlC,IAAelE,EAAWiE,MAC1BC,IAAelE,EAAWyF,WAGjCvB,IAAelE,EAAW+E,OACzB,cAAC,EAAD,CACG7E,UAAW6D,EAAK7D,UAChBC,YAAaA,EAAYkB,QACzBjB,aAAcA,EACdC,UAAW,kCAAM+D,EAAS/C,eAAf,aAAM,EAAkBM,MAAxB,MAIzB,EAkBc0E,UAfsC,SAAC,GAAa,IAAZ7C,EAAW,EAAXA,MACpD,OACG,qBAAK8C,GAAG,OAAR,SACG,cAAC,IAAD,CAAUC,MAAOC,IAAjB,SACG,cAACC,EAAA,EAAD,CACGC,MAAM,eACN1B,KAAK,cACLxB,MAAOA,EAAQmD,SAASnD,GAAS,EACjCoD,aAAa,EACbC,UAAW,SAAAvD,GAAG,OAAI,cAAC,EAAD,CAAOA,IAAKA,EAAKE,MAAOA,EAAQmD,SAASnD,GAAS,GAAtD,OAI5B,C","file":"static/js/14.b0ac1f07.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/wrong4.495ef702.mp3\";","import { FC, useCallback, useEffect, useState, useRef } from 'react';\r\nimport { Provider, useDispatch, useSelector } from \"react-redux\";\r\nimport Store from '../stores/study';\r\nimport { StudyActions, StudyStatus } from '../stores/study/reducer';\r\nimport StudyLayout from '../layouts/StudyLayout';\r\nimport AudioButton, { Refs as AudioButtonRefs } from '../componens/study/AudioButton';\r\nimport { addClass, removeClass } from '../utils';\r\nimport LetterTeamsQuiz from '../componens/study/LetterTeamsQuiz';\r\nimport { Sound } from '@pixi/sound';\r\n\r\nimport '../assets/scss/study-common.scss';\r\nimport '../assets/scss/study-letter-teams.scss';\r\n\r\n\r\n\r\nenum QuizStatus {\r\n   INIT = 'INIT',\r\n   INTRO = 'INTRO',\r\n   START = 'START'\r\n}\r\n\r\n\r\nconst Study: FC<{idx: number, stage: number}> = ({ idx, stage }) => {\r\n   \r\n   const dispatch = useDispatch();\r\n   const studyData: any = useSelector<any>(state => state.studyData);\r\n   const status: any = useSelector<any>(state => state.status);\r\n   const activeIndex: any = useSelector<any>(state => state.activeIndex);\r\n   const data = studyData.list[idx-1];\r\n\r\n   const [quizStatus, setQuizStatus] = useState<QuizStatus>(QuizStatus.INIT);\r\n   const audioBtn = useRef<AudioButtonRefs>(null);\r\n   const syllableBox = useRef<HTMLDivElement[]>([]);\r\n   const wordsAudio = useRef<Sound>();\r\n   const audios = useRef<Sound[]>([]);\r\n   const timer = useRef<any>();\r\n\r\n   const audioFinish = useCallback(( idx: number ) => {\r\n      const isSilent = data.syllables.findIndex((syllable: any) => syllable.isSilent);\r\n      const withSilent = data.syllables.findIndex((syllable: any) => syllable.withSilient);\r\n      const length = isSilent > -1 ? data.syllables.length -1 : data.syllables.length;\r\n\r\n      if(idx <= length) {\r\n         syllableBox.current.forEach(syllable => removeClass(syllable, 'playing'));\r\n         timer.current = setTimeout(() => {   \r\n            if(idx == length){\r\n               wordsAudio.current!.play(() => audioFinish(idx+1));\r\n               syllableBox.current.forEach(syllable => addClass(syllable, 'playing'));\r\n            } else {\r\n               if(idx === withSilent) {\r\n                  audios.current[idx].play(() => audioFinish(idx + 1));\r\n                  addClass(syllableBox.current[idx], 'playing');\r\n                  addClass(syllableBox.current[isSilent], 'playing');\r\n               } else {\r\n                  audios.current[idx].play(() => audioFinish(idx + 1));\r\n                  addClass(syllableBox.current[idx], 'playing');\r\n               }\r\n            }\r\n         }, 100);\r\n      } else {\r\n         syllableBox.current.forEach(syllable => removeClass(syllable, 'playing'));\r\n         setQuizStatus(QuizStatus.START);\r\n      }\r\n   }, [quizStatus, syllableBox.current]);\r\n\r\n   const onStudyClear = useCallback(() => {\r\n      dispatch({ \r\n         type: StudyActions.CHANGE_STATUS, \r\n         payload: StudyStatus.STUDY_END\r\n      });\r\n   }, []);\r\n\r\n   const stopAudio = () => {\r\n      audios.current.forEach(audio => audio.stop());\r\n   }\r\n   \r\n\r\n   useEffect(() => {\r\n      if(status === StudyStatus.STUDY_START) {\r\n         clearTimeout(timer.current);\r\n         if(idx === activeIndex + 1){\r\n            timer.current = setTimeout(()=>{\r\n               setQuizStatus(QuizStatus.INTRO);\r\n            }, 500);\r\n         } else {\r\n            setQuizStatus(QuizStatus.INIT);\r\n            stopAudio();\r\n            syllableBox.current.forEach( box => {\r\n               removeClass(box, 'playing');\r\n               removeClass(box, 'active');\r\n               removeClass(box, 'clear');\r\n            });\r\n         }\r\n      } else if(status === StudyStatus.STUDY_TRANSITION || status === StudyStatus.RESULT) {\r\n         clearTimeout(timer.current);\r\n         stopAudio();\r\n      }\r\n   }, [status]);\r\n\r\n   useEffect(() => {\r\n      if(quizStatus === QuizStatus.INTRO) {\r\n         timer.current = setTimeout(()=>{\r\n            audios.current[0].play(() => audioFinish(1));\r\n            addClass(syllableBox.current[0], 'playing');\r\n         }, 500);\r\n      }\r\n   }, [quizStatus]);\r\n\r\n   useEffect(() => {\r\n      wordsAudio.current = Sound.from({url: data.words.audio, preload: true}); \r\n      data.syllables.forEach((syllable: any, i: number) => {\r\n         if(syllable.audio) {\r\n            audios.current[i] = Sound.from({url: syllable.audio, preload: true});\r\n         }\r\n      });\r\n   },[]);\r\n   \r\n\r\n   return (\r\n      <>\r\n         <div className=\"quiz-view\">\r\n            <div className=\"syllable-boxs\">\r\n               {data.syllables.map((syllable: any, i: number) => (\r\n                  <div ref={ref => ref && (syllableBox.current[i] = ref)}\r\n                     className={`syllable-box ${syllable.isTarget ? 'target' : ''}`}\r\n                     style={{letterSpacing: syllable.text.length === 3 ? '-5px' : '0px'}}\r\n                     key={`word-${i}`}>\r\n                     {syllable.text}\r\n                  </div>\r\n               ))}\r\n            </div>\r\n            <AudioButton\r\n               ref={audioBtn}\r\n               left=\"14px\"\r\n               top=\"11px\"\r\n               src={data.words.audio} \r\n               disabled={\r\n                  quizStatus === QuizStatus.INIT || \r\n                  quizStatus === QuizStatus.INTRO\r\n               } />  \r\n         </div>\r\n         { quizStatus === QuizStatus.START && \r\n            <LetterTeamsQuiz\r\n               syllables={data.syllables}\r\n               syllableBox={syllableBox.current}\r\n               onStudyClear={onStudyClear}\r\n               audioStop={() => audioBtn.current?.stop()} />\r\n         }\r\n      </>\r\n   )\r\n}\r\n\r\n\r\nconst LetterTeamsStudy: FC<{stage: string | null}> = ({stage}) => {\r\n   return (\r\n      <div id=\"wrap\">\r\n         <Provider store={Store}>\r\n            <StudyLayout \r\n               title=\"Balloon Ride\"\r\n               type=\"LetterTeams\"\r\n               stage={stage ? parseInt(stage) : 1}\r\n               showGameBtn={true}\r\n               studyElem={idx => <Study idx={idx} stage={stage ? parseInt(stage) : 1} />} />\r\n         </Provider>\r\n      </div>\r\n   )\r\n}\r\n\r\nexport default LetterTeamsStudy;","import { FC, useState, useRef, useCallback, useLayoutEffect, useEffect } from 'react';\r\nimport { addClass, elementIndex, makeRandomIgnoreFirst, removeClass } from '../../utils';\r\nimport Draggable from './Draggable';\r\nimport { Sound } from '@pixi/sound';\r\n\r\n\r\nexport interface Props {\r\n   syllables: any[];\r\n   onStudyClear: () => void;\r\n   syllableBox: HTMLDivElement[];\r\n   audioStop: () => void;\r\n}\r\n\r\nconst LetterTeamsQuiz: FC<Props> = ({syllables, syllableBox, onStudyClear, audioStop}) => {\r\n   const [randomAr, setRandomAr] = useState<number[]>();\r\n   const correctAudio = useRef<Sound>();\r\n   const wrongAudio = useRef<Sound>();\r\n\r\n   const onDragCorrect = useCallback((item: HTMLDivElement, area: HTMLDivElement) => {\r\n      stopAudio();\r\n      var areaIdx = elementIndex(area);\r\n      removeClass(syllableBox[areaIdx], 'active');\r\n      addClass(syllableBox[areaIdx], 'clear');\r\n      correctAudio.current!.play(() => {\r\n         if(area.nextElementSibling) {\r\n            const nextArea = area.nextElementSibling as HTMLElement;\r\n            nextArea.style.visibility = 'visible';\r\n            addClass(syllableBox[areaIdx+1], 'active');\r\n         } else {\r\n            onStudyClear();\r\n         }\r\n      });\r\n   }, []);\r\n\r\n   const onDragWrong = useCallback((item: HTMLDivElement) => {\r\n      stopAudio();\r\n      wrongAudio.current!.play();\r\n   }, []);\r\n\r\n   const stopAudio = useCallback(() => {\r\n      correctAudio.current!.stop();\r\n      wrongAudio.current!.stop();\r\n   }, []);\r\n\r\n   useLayoutEffect(() => {\r\n      setRandomAr(makeRandomIgnoreFirst(0, syllables.length, syllables.length));\r\n   },[]);\r\n\r\n   useEffect(() => {\r\n      addClass(syllableBox[0], 'active');\r\n      correctAudio.current = Sound.from({url: require('../../assets/audio/correct.mp3').default, preload: true});\r\n      wrongAudio.current = Sound.from({url: require('../../assets/audio/wrong4.mp3').default, preload: true});\r\n      return () => {\r\n         correctAudio.current?.destroy();\r\n         wrongAudio.current?.destroy();\r\n      }\r\n   }, []);\r\n\r\n\r\n   return (\r\n      <div className=\"letter-teams-quiz\">\r\n         {randomAr && \r\n            <Draggable \r\n               areaAr={syllables.map(syllable => syllable.text)}\r\n               dragAr={randomAr.map(i => syllables[i].text)}\r\n               dragElm={randomAr.map( i => (\r\n                  <span className={`${syllables[i].isTarget ? 'target' : ''}`}>{syllables[i].text}</span>\r\n               ))}\r\n               onDragStart={audioStop}\r\n               onCorrect={onDragCorrect}\r\n               onWrong={onDragWrong}\r\n               padding={'20%'} />\r\n         }\r\n      </div>\r\n   )\r\n}\r\n\r\nexport default LetterTeamsQuiz;"],"sourceRoot":""}