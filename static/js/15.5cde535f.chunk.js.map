{"version":3,"sources":["assets/audio/wrong4.mp3","pages/PhonicsStudy.tsx","componens/study/PhonicsQuiz.tsx"],"names":["QuizStatus","PhonicsQuiz","words","wordBox","onStudyClear","audioStop","useState","randomAr","setRandomAr","correctAudio","useRef","wrongAudio","onDragCorrect","useCallback","item","area","stopAudio","areaIdx","elementIndex","removeClass","addClass","current","play","nextElementSibling","style","display","onDragWrong","stop","useLayoutEffect","makeRandom","length","useEffect","Sound","from","url","require","default","preload","destroy","className","Draggable","areaAr","dragAr","map","i","dragElm","onDragStart","onCorrect","onWrong","Study","idx","dispatch","useDispatch","studyData","useSelector","state","status","activeIndex","data","list","INIT","quizStatus","setQuizStatus","audioBtn","audios","timer","audioFinish","setTimeout","START","type","StudyActions","CHANGE_STATUS","payload","StudyStatus","STUDY_END","forEach","audio","STUDY_START","clearTimeout","INTRO","box","STUDY_TRANSITION","RESULT","audio1","audio2","audio3","audio4","audio6","src","image","ref","word","AudioButton","left","top","audio5","disabled","PhonicsStudy","stage","id","store","Store","StudyLayout","title","parseInt","studyElem"],"mappings":"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","file":"static/js/15.5cde535f.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/wrong4.495ef702.mp3\";","import { FC, useCallback, useEffect, useState, useRef } from 'react';\r\nimport { Provider, useDispatch, useSelector } from \"react-redux\";\r\nimport Store from '../stores/study';\r\nimport { StudyActions, StudyStatus } from '../stores/study/reducer';\r\nimport StudyLayout from '../layouts/StudyLayout';\r\nimport AudioButton, { Refs as AudioButtonRefs } from '../componens/study/AudioButton';\r\nimport { addClass, removeClass } from '../utils';\r\nimport PhonicsQuiz from '../componens/study/PhonicsQuiz';\r\nimport { Sound } from '@pixi/sound';\r\n\r\nimport '../assets/scss/study-common.scss';\r\nimport '../assets/scss/study-phonics.scss';\r\n\r\n\r\n\r\nenum QuizStatus {\r\n   INIT = 'INIT',\r\n   INTRO = 'INTRO',\r\n   START = 'START'\r\n}\r\n\r\n\r\nconst Study: FC<{idx: number}> = ({ idx }) => {\r\n   \r\n   const dispatch = useDispatch();\r\n   const studyData: any = useSelector<any>(state => state.studyData);\r\n   const status: any = useSelector<any>(state => state.status);\r\n   const activeIndex: any = useSelector<any>(state => state.activeIndex);\r\n   const data = studyData.list[idx-1];\r\n\r\n   const [quizStatus, setQuizStatus] = useState<QuizStatus>(QuizStatus.INIT);\r\n   const audioBtn = useRef<AudioButtonRefs>(null);\r\n   const wordBox = useRef<HTMLDivElement[]>([]);\r\n   const audios = useRef<Sound[]>([]);\r\n   const timer = useRef<any>();\r\n\r\n   const audioFinish = useCallback(( idx: number ) => {\r\n      if(idx < 4) {\r\n         removeClass(wordBox.current[0], 'playing');\r\n         removeClass(wordBox.current[1], 'playing');\r\n         removeClass(wordBox.current[2], 'playing');\r\n         timer.current = setTimeout(() => {   \r\n            audios.current[idx+1].play(() => audioFinish(idx+1));\r\n            if(idx === 0) {\r\n               addClass(wordBox.current[1], 'playing');\r\n            } else if(idx === 1) {\r\n               addClass(wordBox.current[2], 'playing');\r\n            } else if(idx === 2) {\r\n               addClass(wordBox.current[1], 'playing');\r\n               addClass(wordBox.current[2], 'playing');\r\n            } else {\r\n               addClass(wordBox.current[0], 'playing');\r\n               addClass(wordBox.current[1], 'playing');\r\n               addClass(wordBox.current[2], 'playing');\r\n            }\r\n         }, 100);\r\n      } else {\r\n         setQuizStatus(QuizStatus.START);\r\n         removeClass(wordBox.current[0], 'playing');\r\n         removeClass(wordBox.current[1], 'playing');\r\n         removeClass(wordBox.current[2], 'playing');\r\n      }\r\n   }, [quizStatus, wordBox.current]);\r\n\r\n   const onStudyClear = useCallback(() => {\r\n      dispatch({ \r\n         type: StudyActions.CHANGE_STATUS, \r\n         payload: StudyStatus.STUDY_END\r\n      });\r\n   }, []);\r\n\r\n   const stopAudio = () => {\r\n      audios.current.forEach(audio => audio.stop());\r\n   }\r\n   \r\n\r\n   useEffect(() => {\r\n      if(status === StudyStatus.STUDY_START) {\r\n         clearTimeout(timer.current);\r\n         if(idx === activeIndex + 1){\r\n            timer.current = setTimeout(()=>{\r\n               setQuizStatus(QuizStatus.INTRO);\r\n            }, 500);\r\n         } else {\r\n            setQuizStatus(QuizStatus.INIT);\r\n            stopAudio();\r\n            wordBox.current.forEach( box => {\r\n               removeClass(box, 'playing');\r\n               removeClass(box, 'active');\r\n               removeClass(box, 'clear');\r\n            });\r\n         }\r\n      } else if(status === StudyStatus.STUDY_TRANSITION || status === StudyStatus.RESULT) {\r\n         clearTimeout(timer.current);\r\n         stopAudio();\r\n      }\r\n   }, [status]);\r\n\r\n   useEffect(() => {\r\n      if(quizStatus === QuizStatus.INTRO) {\r\n         timer.current = setTimeout(()=>{\r\n            audios.current[0].play(() => audioFinish(0));\r\n            addClass(wordBox.current[0], 'playing');\r\n         }, 500);\r\n      }\r\n   }, [quizStatus]);\r\n\r\n   useEffect(() => {\r\n      audios.current[0] = Sound.from({url: data.audio1, preload: true});\r\n      audios.current[1] = Sound.from({url: data.audio2, preload: true});\r\n      audios.current[2] = Sound.from({url: data.audio3, preload: true});\r\n      audios.current[3] = Sound.from({url: data.audio4, preload: true});\r\n      audios.current[4] = Sound.from({url: data.audio6, preload: true});\r\n   },[]);\r\n   \r\n\r\n   return (\r\n      <>\r\n         <div className=\"quiz-view\">\r\n            <div className=\"image\">\r\n               <img src={data.image} />\r\n            </div>\r\n            <div className=\"word-boxs\">\r\n               <div ref={ref => ref && (wordBox.current[0]=ref)} \r\n                  className={`word-box box1`}>\r\n                  <span>{data.word[0]}</span>\r\n               </div>\r\n               <div ref={ref => ref && (wordBox.current[1]=ref)} \r\n                  className={`word-box box2`}>\r\n                  <span>{data.word[1]}</span>\r\n               </div>\r\n               <div ref={ref => ref && (wordBox.current[2]=ref)} \r\n                  className={`word-box box3`}>\r\n                  <span>{data.word[2]}</span>\r\n               </div>\r\n            </div>\r\n            <AudioButton\r\n               ref={audioBtn}\r\n               left=\"21px\"\r\n               top=\"18px\"\r\n               src={data.audio5} \r\n               disabled={\r\n                  quizStatus === QuizStatus.INIT || \r\n                  quizStatus === QuizStatus.INTRO\r\n               } />  \r\n         </div>\r\n         { quizStatus === QuizStatus.START && \r\n            <PhonicsQuiz\r\n               words={[data.word[0], data.word[1], data.word[2]]}\r\n               wordBox={wordBox.current}\r\n               onStudyClear={onStudyClear}\r\n               audioStop={() => audioBtn.current?.stop()} />\r\n         }\r\n      </>\r\n   )\r\n}\r\n\r\n\r\nconst PhonicsStudy: FC<{stage: string | null}> = ({stage}) => {\r\n   return (\r\n      <div id=\"wrap\">\r\n         <Provider store={Store}>\r\n            <StudyLayout \r\n               title=\"Phonics Golden Shooting\"\r\n               type=\"Phonics\"\r\n               stage={stage ? parseInt(stage) : 1}\r\n               studyElem={ idx => (\r\n                  <Study idx={idx} />)\r\n               } />\r\n         </Provider>\r\n      </div>\r\n   )\r\n}\r\n\r\nexport default PhonicsStudy;","import { FC, useCallback, useEffect, useLayoutEffect, useRef, useState } from 'react';\r\nimport Draggable from './Draggable';\r\nimport { addClass, elementIndex, makeRandom, removeClass } from '../../utils';\r\nimport { Sound } from '@pixi/sound';\r\n\r\n/*\r\n* @ PROPS\r\n*     words: 단어 배열\r\n*     wordBox: 단어 박스 element\r\n*     onStudyClear: 학습 완료 콜백\r\n*     audioStop: play중인 오디오 정지\r\n*/\r\nexport interface Props {\r\n   words: string[];\r\n   wordBox: HTMLDivElement[];\r\n   onStudyClear: () => void;\r\n   audioStop: () => void;\r\n}\r\n\r\nconst PhonicsQuiz: FC<Props> = ({ words, wordBox, onStudyClear, audioStop }) => {\r\n   \r\n   const [randomAr, setRandomAr] = useState<number[]>();\r\n   const correctAudio = useRef<Sound>();\r\n   const wrongAudio = useRef<Sound>();\r\n\r\n   const onDragCorrect = useCallback((item: HTMLDivElement, area: HTMLDivElement) => {\r\n      stopAudio();\r\n      var areaIdx = elementIndex(area);\r\n      removeClass(wordBox[areaIdx], 'active');\r\n      addClass(wordBox[areaIdx], 'clear');\r\n      correctAudio.current!.play(() => {\r\n         if(area.nextElementSibling) {\r\n            const nextArea = area.nextElementSibling as HTMLElement;\r\n            nextArea.style.display = 'block';\r\n            addClass(wordBox[areaIdx+1], 'active');\r\n         } else {\r\n            onStudyClear();\r\n         }\r\n      });\r\n   }, []);\r\n\r\n   const onDragWrong = useCallback((item: HTMLDivElement) => {\r\n      stopAudio();\r\n      wrongAudio.current!.play();\r\n   }, []);\r\n\r\n   const stopAudio = useCallback(() => {\r\n      correctAudio.current!.stop();\r\n      wrongAudio.current!.stop();\r\n   }, []);\r\n\r\n   useLayoutEffect(() => {\r\n      setRandomAr(makeRandom(words.length, words.length));\r\n   },[]);\r\n\r\n   useEffect(() => {\r\n      addClass(wordBox[0], 'active');\r\n      correctAudio.current = Sound.from({url: require('../../assets/audio/correct.mp3').default, preload: true});\r\n      wrongAudio.current = Sound.from({url: require('../../assets/audio/wrong4.mp3').default, preload: true});\r\n      return () => {\r\n         correctAudio.current?.destroy();\r\n         wrongAudio.current?.destroy();\r\n      }\r\n   }, []);\r\n\r\n   return (\r\n      <div className=\"phonics-quiz\">\r\n         {randomAr && \r\n            <Draggable \r\n               areaAr={words}\r\n               dragAr={randomAr.map(i => words[i])}\r\n               dragElm={randomAr.map( i => (<span>{words[i]}</span>))}\r\n               onDragStart={audioStop}\r\n               onCorrect={onDragCorrect}\r\n               onWrong={onDragWrong} />\r\n         }\r\n         \r\n      </div>\r\n   )\r\n}\r\n\r\nexport default PhonicsQuiz;"],"sourceRoot":""}